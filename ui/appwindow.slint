import { Button, VerticalBox, GridBox, CheckBox, ComboBox, Switch, Spinner, LineEdit, ListView, AboutSlint, ProgressIndicator, SpinBox, HorizontalBox, StandardListView, TabWidget } from "std-widgets.slint";

export global varfn {
    in-out property <string> usericon;
    in-out property <string> username;
    in-out property <string> olnstatus;

    in-out property < [[string]]> rooms;
    in-out property < [[string]]> messages;

    // in-out property <int> isandroid : 0; 
    pure callback isandroid() -> int;

}

component Splitter inherits TouchArea {
    width: 4px;
    mouse-cursor: ew-resize;

    padding: 0px;
    Rectangle {
        padding: 0px;
        width: 100%;
        height: 100%;
        background: blue;
    }
}
component HSpacer inherits Rectangle {
    max-height: 3px;
    // width: 100%;
    horizontal-stretch: 1;
}
component HSpacer inherits Rectangle {
    max-width: 3px;
    vertical-stretch: 1;
}


component UserInfo inherits  Rectangle {
    padding: 0px;
    HorizontalBox {
        padding: 0px;
        Image {
            max-height: 22px;
            max-width: 22px;
        }
        VerticalBox {
            padding: 0px;
            Text {text: "hhhh444";}
            Text {text: "hhhh555";}
        }
        HorizontalBox {
            padding: 0px;
            Text {text: "hhhh111";}
            Text {text: "hhhh222";}
            Text {text: "hhhh333";}
        }
    }
}

component RoomItemui inherits TouchArea {
    padding: 0px;
    
    HorizontalBox {
        padding: 0px;
        Image {
            padding: 0px;
            // colorize: #3016d6;

            max-height: 22px;
            max-width: 22px;
            // error: Cannot find image file https:
            // source: @image-url("https://interactive-examples.mdn.mozilla.net/media/examples/border-diamonds.png");
            // 添加这个属性，直接文件大小+10M???
            // source: @image-url("/home/mememe/Downloads/border-diamonds.png");
            source: @image-url("");
        }
        VerticalBox {
            padding: 0px;

            LineEdit {
                max-height: 16px;
            }
            HorizontalBox {
                padding: 0px;
                Text {text: "hhhh111";}
                Text {text: "hhhh222";}
                Text {text: "hhhh333";}
            }
            Text {text: "hhhh444";}
            Text {text: "hhhh555";}
        }
    }
}

component RoomListBottom inherits Rectangle {
    padding: 0px;

    HorizontalBox {
        padding: 0px;

        Button {text: "fff111";}
        Button {text: "fff222";}
        Button {text: "fff333";}
        Button {text: "fff444";}
        // Button {text: "fff555";}
    }
}

component MessageListHead inherits Rectangle {
    in-out property <int> msgcnt;

    padding: 0px;
    HorizontalBox {
        padding: 0px;

        Button {
            text: "btn111";
        }
        Text {text: "ttt呵呵222";}
        Text {text: "ttt呵呵ccc"+msgcnt;}
        Button {
            text: "btn222";
        }
        // Button {
        //     text: "btn333";
        // }
    }
}

component MessageListItemui inherits Rectangle {
    in-out property <string> msgtm;
    in-out property <string> msgchan;
    in-out property <string> msguser;
    in-out property <string> msgtext;

    // background: #743734;
    padding: 0px;
    HorizontalBox {
        padding: 3px;
        Image {
            max-width: 22px;
            max-height: 22px;
            // source: @image-url("/home/mememe/Downloads/favicon.png");
            source: @image-url("");
            image-fit: fill;
        }
        Text {text: "ddttt呵呵111";}
        Text {text: "ttt呵呵222";}
        Text {text: "ttt呵呵333";}
        Text {text: msgchan;}
        Text {text: "tttvxt呵呵555";}
        Image {
            max-width: 22px;
        }
    }
}

component MessageListTail inherits Rectangle {
    in-out property<string> iptval: "nam要m";
    in-out property <string> selfile;

    padding: 0px;
    HorizontalBox {
        padding: 0px;
        Image {
            max-width: 22px;
            max-height: 22px;
        }
        Image {
            max-width: 22px;
            max-height: 22px;
        }
        LineEdit {
            text: iptval;
        }
        Button {
            text: "btn111";
        }
        Image {
            max-width: 22px;
            max-height: 22px;
        }
    }
}

component RoomListAndUserInfo inherits Rectangle {
    in property <[[string]]> rooms;
    rooms: [["ffff"],["gggggg"], ["hhhhhhh"], ["iiiiiii"], ["jjjjjjjj"], ["kkkkkkkk"], ["lllllllll"],["mmmmmmmm"],["nnnnnnnnnn"]];


    padding: 0px;
        VerticalBox {
            padding: 0px;

            LineEdit {}

            UserInfo {}

            ListView {
                padding: 0px;
                for v in root.rooms : 
                     RoomItemui {}
            }

            RoomListBottom {}
            LineEdit {}
        }
}

component mytabwidget inherits TabWidget {

}

// macos cupertino, android material, other fluent
// cosmic 还可以，看看不能用在android上。
// slint的 material 是设计的最差的。
// material的 padding 很大，需要调整为0px

export component AppWindow inherits Window {
    in-out property <string> usericon;
    in-out property <string> username;
    in-out property <string> olnstatus;

    in property <[[string]]> rooms;
    in property <[string]> columns;
    in property <[[string]]> messages;

    callback justrunafunc();

    messages: [["ffff"],["gggggg"], ["hhhhhhh"], ["iiiiiii"], ["jjjjjjjj"], ["kkkkkkkk"], ["lllllllll"],["mmmmmmmm"],["nnnnnnnnnn"],["gggggg"], ["hhhhhhh"], ["iiiiiii"], ["jjjjjjjj"], ["kkkkkkkk"], ["lllllllll"],["mmmmmmmm"],["nnnnnnnnnn"],["gggggg"], ["hhhhhhh"], ["iiiiiii"], ["jjjjjjjj"], ["kkkkkkkk"], ["lllllllll"],["mmmmmmmm"],["nnnnnnnnnn"],["gggggg"], ["hhhhhhh"], ["iiiiiii"], ["jjjjjjjj"], ["kkkkkkkk"], ["lllllllll"],["mmmmmmmm"],["nnnnnnnnnn"]];

    padding: 0px;
    HorizontalBox {
        padding: 1px;

        if varfn.isandroid() != 1: RoomListAndUserInfo{}
        if varfn.isandroid() != 1: Splitter {
            // x: parent.width - self.width;
            // height: 100%;

            moved => {
                // self.x = min(parent.width - self.width, max(400px, self.x + self.mouse-x - self.pressed-x));
            }
        }

        tw := TabWidget {
            tb0 := Tab {
                title: "000";
                VerticalBox {
                    padding: 1px;
                // LineEdit {}
                // LineEdit {}
                // LineEdit {}
                // LineEdit {}
                    if varfn.isandroid() == 1:  RoomListAndUserInfo{}
                }
            }
            Tab {
                title: "111";
                // message list 主窗口
                VerticalBox {
                    padding: 0px;
                    MessageListHead {
                        msgcnt: messages.length;
                    }
                    ListView {
                        padding: 0px;
                        for v in root.messages : 
                        MessageListItemui {
                            msgchan:  v[0];
                        }
                        
                    }
                    MessageListTail {}
                }
            }
            Tab {
                title: "222";
                Button {text: "sssss";}
            }
            Tab {
                title: "333";
                Button {text: "sssss";}
            }
            
        }
        
    }

    states [
        onosandroid when varfn.isandroid() == 1 : {
            tw.current-index: 0;
        }
        onpc when varfn.isandroid() != 1 : {
            tw.current-index: 1;
        }
    ]

    init => {
        debug("AppWindow inited,"+varfn.isandroid());
        // if varfn.isandroid() != 1 {
        //     tw.current-index = 1;
        // //     tb0.opacity = 1;
        // //     tb0.visible = false;
        // }else{
        //     tw.current-index = 0;
        // }
    }
}

